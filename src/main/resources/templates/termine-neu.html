<!DOCTYPE html>
<html lang="en"
      th:replace="~{mopslayout :: html(name='Terminfindung', title='Neuer Termin',
                  headcontent=~{:: headcontent}, navigation=~{:: navigation},
                  bodycontent=~{:: bodycontent})}"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>Neuer Termin</title>
    <th:block th:fragment="headcontent">
        <!-- Links, Scripts, Styles -->

        <!-- jQuery -->
        <script crossorigin="anonymous"
                integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
                src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

        <!-- PopperJS -->
        <script crossorigin="anonymous"
                integrity="sha256-O17BxFKtTt1tzzlkcYwgONw4K59H+r1iI8mSQXvSf5k="
                src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/popper.min.js"></script>

        <!-- Bootstrap -->
        <link crossorigin="anonymous"
              href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
              integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
              rel="stylesheet">
        <script crossorigin="anonymous"
                integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
                src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

        <!-- Font Awesome -->
        <link href="/css/all.css"
              rel="stylesheet">

        <!-- MomentJS -->
        <script crossorigin="anonymous"
                integrity="sha256-AdQN98MVZs44Eq2yTwtoKufhnU+uZ7v2kXnD5vqzZVo="
                src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script>

        <!-- Tempus Dominus -->
        <link crossorigin="anonymous"
              href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.1.2/css/tempusdominus-bootstrap-4.min.css"
              integrity="sha256-XPTBwC3SBoWHSmKasAk01c08M6sIA5gF5+sRxqak2Qs="
              rel="stylesheet"/>
        <script crossorigin="anonymous"
                integrity="sha256-z0oKYg6xiLq3yJGsp/LsY9XykbweQlHl42jHv2XTBz4="
                src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.1.2/js/tempusdominus-bootstrap-4.min.js"></script>
    </th:block>
</head>

<body>
<header>
    <nav class="navigation navigation-secondary" is="mops-navigation" th:fragment="navigation">
        <!-- Navigation als ungeordnete Liste mit einfachen Links hier einfügen! -->
        <ul>
            <li>
                <a th:href="@{/termine2}">
                    <img src="../static/img/resized/calendar_small.jpg"
                         th:src="@{/img/resized/calendar_small.jpg}">
                    Termine
                </a>
            </li>

            <li>
                <a th:href="@{/termine2/umfragen}">
                    <img src="../static/img/resized/survey_small.jpg"
                         th:src="@{/img/resized/survey_small.jpg}">
                    Umfragen
                </a>
            </li>
        </ul>
    </nav>
</header>

<main th:fragment="bodycontent">
    <div class="container mb-3">
        <!-- Header -->
        <div class="row my-3 border-bottom">
            <h1 class="h1">Neuer Termin</h1>
        </div>

        <form class="row" method="post" th:action="@{/termine2/termine-neu}" th:object="${terminfindung}">
            <div class="col">
                <!-- Übersicht -->
                <div class="mb-3 border-bottom">
                    <div class="mb-3 form-group">
                        <label for="titel">
                            Titel
                        </label>

                        <input class="form-control" id="titel" name="titel" placeholder="Worum geht es?"
                               required th:value="*{titel}" type="text"/>
                    </div>

                    <!-- Ort -->
                    <div class="mb-3 form-group">
                        <label for="ort">
                            Ort
                        </label>

                        <input class="form-control" id="ort" name="ort" placeholder="Wo soll man sich treffen?"
                               required th:value="*{ort}" type="text"/>
                    </div>

                    <!-- Erreichbarkeit -->
                    <div class="mb-3 form-group">
                        <label for="erreichbarkeit">
                            Erreichbarkeit
                        </label>

                        <select class="custom-select" disabled
                                id="erreichbarkeit" th:if="${gruppen.size() == 0}">
                            <option selected th:value="-1">Link</option>
                        </select>

                        <select class="custom-select"
                                th:field="${gruppeSelektiert.id}" th:if="${gruppen.size() != 0}">
                            <option selected th:value="-1">Link</option>

                            <optgroup label="Gruppen">
                                <option th:each="gruppe, iter : ${gruppen}"
                                        th:text="${gruppe.name}"
                                        th:value="${gruppen[__${iter.index}__].id}">Gruppe
                                </option>
                            </optgroup>
                        </select>

                        <div class="mt-2 mx-4 text-secondary" style="font-size: small">
                            <p class="mb-1">
                                <b>Link</b>: Die Abstimmung ist für alle sichtbar, die den Link
                                kennen. Der Link wird dabei automatisch vom System generiert.
                            </p>

                            <p>
                                <b>Gruppe</b>: Die Abstimmung ist für alle Mitglieder der
                                ausgewählten Gruppe sichtbar.

                                <span class="text-warning" th:if="${gruppen.size() == 0}">
										Diese Option ist aber nicht verfügbar, da es im Moment keine
										Gruppenzugehörigkeit gibt.
									</span>
                            </p>
                        </div>
                    </div>

                    <!-- Beschreibung -->
                    <div class="mb-3 form-group">
                        <label class="text-secondary" for="beschreibung">
                            Beschreibung (optional)
                        </label>

                        <textarea class="form-control" id="beschreibung" placeholder="Gibt es Besonderheiten oder Anmerkungen?"
                                  rows="4"
                                  th:field="*{beschreibung}" type="text"></textarea>
                    </div>
                </div>

                <!-- Zeiten -->
                <div class="mb-3 border-bottom">
                    <h2 class="h2">
                        Zeiten


                    </h2>

                    <div class="container mb-3">
                        <!-- Datum und Uhrzeit -->
                        <div class="row" th:each="zeit, iter : *{vorschlaege}">
                            <div class="col-sm-6">
                                <div class="form-group mb-2">
                                    <div class="input-group date"
                                         data-target-input="nearest"
                                         th:id="zeit+${iter.count}">
                                        <input class="form-control datetimepicker-input"
                                               placeholder="Datum und Stunde"
                                               th:attr="data-target='#zeit'+${iter.count}"
                                               th:field="*{vorschlaege[__${iter.index}__]}"
                                               type="text"/>

                                        <div class="input-group-append"
                                             data-toggle="datetimepicker"
                                             th:attr="data-target='#zeit'+${iter.count}">
                                            <div class="input-group-text">
                                                <i class="fa fa-calendar"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-3" th:if="*{vorschlaege.size() > 1}">
                                <button class="btn btn-danger" name="delete" th:value="${iter.index}" type="submit">
                                    Löschen
                                </button>
                            </div>

                            <script th:inline="javascript">
                                /* This comment is necessary for thymeleaf inline, DO NOT REMOVE */
                                /*[+

                                $(function () {
                                    var pickerID = '#zeit' + '[[${iter.count}]]';
                                    var now = [[${#temporals.format(jetzt, 'MM/dd/yyyy')}]];

                                    $(pickerID).datetimepicker({
                                        format: 'DD.MM.YYYY, HH:mm',
                                        minDate: now,
                                        locale: 'de'
                                    });
                                });

                                +]*/
                            </script>
                        </div>

                        <div class="row justify-content-center mt-1">
                            <button class="btn btn-outline-success" name="add" type="submit">
                                Hinzufügen
                            </button>
                        </div>

                        <div class="form-group mt-3">
                            <label for="file">Select a CSV file</label>
                            <input type="file" name="file" class="form-control-file" id="file" accept=".csv">
                        </div>
                        <button type="submit" name = "upload" class="btn btn-outline-success">Upload CSV</button>
                    </div>
                </div>

                <!-- Frist -->
                <div class="mb-3">
                    <h2 class="h2">
                        Frist
                    </h2>

                    <div class="form-group mb-2">
                        <div class="input-group date"
                             data-target-input="nearest"
                             id="frist">
                            <input class="form-control datetimepicker-input"
                                   data-target="#frist"
                                   placeholder="Bis wann soll man an der Abstimmung teilnehmen können?"
                                   th:field="*{frist}"
                                   type="text"/>

                            <div class="input-group-append"
                                 data-target="#frist"
                                 data-toggle="datetimepicker">
                                <div class="input-group-text">
                                    <i class="fa fa-calendar"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <script type="text/javascript">
                        $(function () {
                            var pickerID = '#frist';

                            $(pickerID).datetimepicker({
                                format: 'DD.MM.YYYY, HH:mm',
                                locale: 'de'
                            });
                        });
                    </script>
                </div>

                <div class="row justify-content-center">
                    <button class="btn btn-success" name="create" type="submit">
                        Erstellen
                    </button>
                </div>
            </div>
        </form>
    </div>
</main>
</body>
</html>

