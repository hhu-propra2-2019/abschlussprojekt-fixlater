<!DOCTYPE html>
<html lang="en"
      th:replace="~{mopslayout :: html(name='Terminfindung', title='Terminabstimmung',
                  headcontent=~{:: headcontent}, navigation=~{:: navigation},
                  bodycontent=~{:: bodycontent})}"
      xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8">
	<title>Terminabstimmung</title>
	<th:block th:fragment="headcontent">
		<!-- Links, Skripts, Styles hier einfügen! -->

		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>


	</th:block>
</head>

<body>
<header>
	<nav class="navigation navigation-secondary" is="mops-navigation" th:fragment="navigation">
		<!-- Navigation als ungeordnete Liste mit einfachen Links hier einfügen! -->
		<ul>
			<li>
				<a th:href="@{/termine2}">
					<img src="../static/img/resized/calendar_small.jpg"
					     th:src="@{/img/resized/calendar_small.jpg}">
					Termine
				</a>
			</li>
			
			<li>
				<a th:href="@{/termine2/umfragen}">
					<img src="../static/img/resized/survey_small.jpg"
					     th:src="@{/img/resized/survey_small.jpg}">
					Umfragen
				</a>
			</li>
		</ul>
	</nav>
</header>

<main th:fragment="bodycontent">
	<div class="container">
		<!-- Header -->
		<div class="row my-3 border-bottom">
			<h1 class="h1">Terminabstimmung</h1>
		</div>
		
		<div class="row">
			<div class="col">
				<!-- Termin -->
				<div class="mb-3 border-bottom">
					<div class="mb-3 p-3 bg-light rounded">
						<!-- Zusammenfassung -->
						<div class="pb-2 border-bottom">
							<div class="h3" th:text="${terminfindung.getTitel()}">
								Titel
							</div>
							
							<div th:text="${terminfindung.getOrt()}">
								Ort
							</div>
						</div>
						
						<!-- Beschreibung -->
						<div class="mt-2" style="font-size: small"
						     th:text="${terminfindung.getBeschreibung()}">
							Floppy macaroni are assumed to be dissatisfying. Few can name a
							springtime flower that doesn't profit from rainstorms. In modern
							times, clothes were lost without the long thin bands that were
							their linen.
						</div>
					</div>
				</div>
				
				<!-- Wahl -->
				<div class="mb-3 border-bottom">
					<div class="d-flex justify-content-between align-items-center">
						<h2 class="h2">Zeiten</h2>

						<a th:href="@{/termine2/{path}(path=${terminfindung.getLink()})/abstimmung}">
							<button class="btn btn-outline-warning">Zurücksetzen</button>
						</a>
					</div>
					
					<form class="my-3" th:action="@{/termine2/{path}(path=${terminfindung.getLink()})}"
					      th:object="${antwort}" method="post">
						<div class="table-responsive">
							<table class="table table-sm" style="text-align: center">
								<thead>
								<tr>
									<!-- blau-gelb-rotes Farbschema für Nutzer mit Sehschwä-
										 chen: Blau und Gelb lassen sich besser unterschei-
										 den als Grün und Gelb. -->
									<th class="col bg-secondary" style="width: 10%"></th>
									<th class="col bg-secondary" style="width: 30%">Termin</th>
									<th class="col bg-secondary" style="width: 10%"></th>
									<th class="col bg-primary" style="width: 16%"> Ja</th>
									<th class="col bg-warning" style="width: 18%"> Vielleicht</th>
									<th class="col bg-danger" style="width: 16%"> Nein</th>
								</tr>
								</thead>
								
								<tbody th:remove="all-but-first" th:each="termin,terminStat: *{termine}" }>
								<tr>
									<!-- abwechselnd bg-white / bg-light -->
									<th class="col bg-white" style="width: 10%"></th>
									<th class="col bg-white font-weight-bold text-black-50"
									    th:text="${antwort.getTermineString()[__${terminStat.index}__]}"
									    style="width: 30px">25.02.2084, 12:15
									</th>
									<th class="col bg-white " style="width: 10%"></th>
									<th class="col table-primary" style="width: 16%">
										<input type="radio"
										       name="abstimmung1"
										       th:name="${termin}"
										       th:field="${antwort.antworten[__${terminStat.index}__]}"
										       value="JA"/>
										
									</th>
									<th class="col table-warning font-weight-bold text-black-50"
									    style="width: 18%">
										<input type="radio"
										       name="abstimmung1"
										       th:name="${termin}"
										       th:field="${antwort.antworten[__${terminStat.index}__]}"
										       value="VIELLEICHT"/>
									</th>
									<th class="col table-danger" style="width: 16%">
										<input type="radio"
										       name="abstimmung1"
										       th:name="${termin}"
										       th:field="${antwort.antworten[__${terminStat.index}__]}"
										       value="NEIN"/>
									</th>
								</tr>
								</tbody>
							</table>
						</div>


						<div style="text-align: center"
						     >
            		<input type="text" name="pseudonym" placeholder="Benjamin"
							       th:placeholder="*{getBenutzer()}"
							       th:field="${antwort.pseudonym}"
                                   th:if="not ${terminfindung.getEinmaligeAbstimmung()} or not ${terminfindung.teilgenommen}">
							<button class="btn btn-primary" type="submit" name="sichern"
							        th:if="not ${terminfindung.getEinmaligeAbstimmung()} or not ${terminfindung.teilgenommen}">
								Abschicken
							</button>

							<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#myModal">
								HILFE!
							</button>

							<!-- The Modal -->
							<div class="modal fade" id="myModal">
								<div class="modal-dialog modal-dialog-centered">
									<div class="modal-content">

										<!-- Modal Header -->
										<div class="modal-header">
											<h4 class="modal-title" th:text="${info.getAchtung()}">Modal Heading</h4>
											<button type="button" class="close" data-dismiss="modal">&times;</button>
										</div>

										<!-- Modal body -->
										<div class="modal-body text-left">
											<ul>
												<li th:text="${info.getErgebnisVorFrist()}">Coffee</li>
												<li th:text="${info.getEinmaligesAbstimmen()}">Coffee</li>
												<li th:text="${info.getAbstimmungsBerechtigungNutzer()}">Coffee</li>
											</ul>
											<div class="text-center">
												!!!DIESE INFORMATIONEN KÖNNEN UNTER HILFE NACHGELESEN WERDEN!!!
											</div>
										</div>

										<!-- Modal footer -->
										<div class="modal-footer">
											<button type="button" class="btn btn-danger" data-dismiss="modal">Gelesen</button>
										</div>

									</div>
								</div>
							</div>
							<script th:inline="javascript" >
                                /*<![CDATA[*/
                                $(window).on('load',function(){
                                    if( [[not ${terminfindung.teilgenommen}]] )
                                        $('#myModal').modal('show');
                                });
                                /*]]>*/
							</script>
						</div>
					</form>
				</div>
				
				<!-- Kommentare -->
				<div>
					<h2 class="h2">Kommentare</h2>
					
					<!-- Vorhandene Kommentare -->
					<div class="mb-3" th:each="kommentar : *{kommentare}">
						<div class="my-3 p-3 bg-light rounded">
							<!-- Sendedaten -->
							<div class="pb-2 border-bottom">
								<h4 class="h4" th:text="${kommentar.pseudonym}">Pseudonym</h4>
								
								<div>
									am
									
									<span th:text="${#temporals.format(kommentar.erstellungsdatum,
									               'dd.MM.yyyy, HH:mm')}">
										Datum
									</span>
								</div>
							</div>
							
							<!-- Inhalt -->
							<div class="mt-2" th:text="${kommentar.inhalt}">
								Inhalt
							</div>
						</div>
					</div>
					
					<!-- Kommentarbox -->
					<div class="container mb-3">
						<h3 class="h3 mb-3">Verfassen</h3>
						
						<form th:action="@{/termine2/{path}(path=${terminfindung.getLink()})}"
						      th:object="${neuerKommentar}" method="post">
							<!-- Inhalt -->
							<div class="mb-3">
								<textarea class="form-control" rows="5" id="comment"
								          th:field="*{inhalt}">
									Inhalt
								</textarea>
							</div>
							
							<!-- Name -->
							<div class="mb-3 form-group">
								<label>Name</label>
								
								<input class="form-control" id="pseudonym"
								       type="text" th:placeholder="*{pseudonym}"
								       th:field="*{pseudonym}"/>
							</div>
							
							<div style="text-align: center">
								<button name="kommentarSichern" class="btn btn-success">Veröffentlichen</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>


</main>
</body>
</html>
